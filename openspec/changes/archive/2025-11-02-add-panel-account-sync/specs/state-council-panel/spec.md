## ADDED Requirements

### Requirement: Government Account Synchronization on Panel Open
當國務院面板開啟時，系統必須（MUST）檢查所有必需的政府帳戶是否存在。若配置存在但帳戶缺失，系統必須（MUST）自動建立缺失的政府帳戶，確保面板功能正常運作。

#### Scenario: 配置存在但帳戶缺失時自動建立
- **GIVEN** 國務院領袖配置已存在
- **AND** 部分或全部政府帳戶缺失
- **WHEN** 使用者開啟國務院面板
- **THEN** 系統自動建立缺失的政府帳戶，使用配置中記錄的 account_id（如存在）或推導方法產生一致的 account_id
- **AND** 建立的帳戶餘額應從經濟系統同步（如經濟帳戶存在）或設為 0（如不存在）

#### Scenario: 所有帳戶存在時無需建立
- **GIVEN** 國務院領袖配置已存在
- **AND** 所有四個部門的政府帳戶都已存在
- **WHEN** 使用者開啟國務院面板
- **THEN** 系統不執行帳戶建立操作，直接顯示面板

#### Scenario: 使用配置中的 account_id 建立帳戶
- **GIVEN** 國務院領袖配置已存在且記錄了各部門的 account_id
- **AND** 內政部帳戶缺失
- **WHEN** 系統自動建立內政部帳戶
- **THEN** 使用配置中記錄的 `internal_affairs_account_id` 作為新帳戶的 account_id

#### Scenario: 配置中 account_id 缺失時使用推導方法
- **GIVEN** 國務院領袖配置已存在但未記錄部門 account_id
- **AND** 財政部帳戶缺失
- **WHEN** 系統自動建立財政部帳戶
- **THEN** 使用 `derive_department_account_id` 方法產生一致的 account_id

#### Scenario: 同步經濟系統餘額
- **GIVEN** 政府帳戶缺失但經濟系統中存在對應的帳戶餘額
- **WHEN** 系統自動建立政府帳戶
- **THEN** 建立的帳戶餘額應與經濟系統中的餘額一致

#### Scenario: 經濟帳戶不存在時設為零餘額
- **GIVEN** 政府帳戶缺失且經濟系統中不存在對應帳戶
- **WHEN** 系統自動建立政府帳戶
- **THEN** 建立的帳戶餘額設為 0

#### Scenario: 並發開啟面板時避免重複建立
- **GIVEN** 多個使用者同時開啟國務院面板
- **AND** 內政部帳戶缺失
- **WHEN** 系統同時處理多個面板開啟請求
- **THEN** 使用資料庫的 ON CONFLICT 機制確保帳戶僅建立一次，所有請求最終看到一致的帳戶狀態

#### Scenario: 部分帳戶缺失時建立所有缺失帳戶
- **GIVEN** 國務院領袖配置已存在
- **AND** 內政部和財政部帳戶存在，但國土安全部和中央銀行帳戶缺失
- **WHEN** 使用者開啟國務院面板
- **THEN** 系統僅建立國土安全部和中央銀行帳戶，保留現有帳戶不變

#### Scenario: 帳戶建立失敗時的降級處理
- **GIVEN** 國務院領袖配置已存在
- **AND** 帳戶建立過程中發生錯誤（如資料庫連線失敗）
- **WHEN** 使用者開啟國務院面板
- **THEN** 系統記錄錯誤日誌但不阻止面板開啟
- **AND** 面板顯示錯誤訊息提示帳戶同步失敗，建議使用者重試或聯繫管理員
